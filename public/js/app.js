var t={login:"Masuk",register:"Daftar",logout:"Keluar",phoneNumber:"Nomor HP",password:"Kata Sandi",fullName:"Nama Lengkap",dashboard:"Dashboard",submit:"Input Data",admin:"Admin Panel",save:"Simpan",cancel:"Batal",edit:"Ubah",delete:"Hapus",back:"Kembali",areaSetting:"Pengaturan Area",currentArea:"Area Saat Ini",editArea:"Ubah Area",province:"Provinsi",kabupatenKota:"Kabupaten/Kota",selectProvince:"Pilih Provinsi",selectKabupaten:"Pilih Kabupaten/Kota",calegSetting:"Pengaturan Caleg",calegName:"Nama Caleg",currentCaleg:"Caleg Saat Ini",editCaleg:"Ubah Caleg",tps:"TPS",village:"Desa/Kelurahan",district:"Kecamatan",totalVotes:"Total Suara",calegVotes:"Suara Caleg",photo:"Foto C1",location:"Lokasi",saveError:"Gagal menyimpan",saveSuccess:"Berhasil disimpan",loginError:"Login gagal",registerSuccess:"Pendaftaran berhasil",loading:"Memuat...",unverifiedUsers:"Pengguna Belum Terverifikasi",verify:"Verifikasi",submissions:"Data Masuk",approve:"Setujui",flag:"Tandai",export:"Ekspor CSV"};var c={email:"",password:"",loading:!1,error:"",login(){this.loading=!0,this.error="";let e={email:this.email,password:this.password};console.log("[FRONTEND LOGIN] Sending body:",e),m.request({method:"POST",url:"/api/auth/login",body:e,headers:{"Content-Type":"application/json"}}).then(a=>{localStorage.setItem("token",a.token),localStorage.setItem("user",JSON.stringify(a.user)),m.route.set("/app/dashboard")}).catch(a=>{this.error=a.error||t.loginError,this.loading=!1,m.redraw()})},view(){return m("main.container",[m("h1",t.login),m("form",{onsubmit:e=>{e.preventDefault(),this.login()}},[m("label",{for:"email"},t.email||"Email"),m("input",{id:"email",type:"email",value:this.email,oninput:e=>{this.email=e.target.value},required:!0}),m("label",{for:"password"},t.password),m("input",{id:"password",type:"password",value:this.password,oninput:e=>{this.password=e.target.value},required:!0}),m("button[type=submit]",{disabled:this.loading},t.login),this.error&&m("div.error",this.error)]),m("p",["Belum punya akun? ",m("a",{href:"#!/app/register"},t.register)])])}};var p={fullName:"",phoneNumber:"",password:"",loading:!1,error:"",success:"",register(){this.loading=!0,this.error="",this.success="",m.request({method:"POST",url:"/api/auth/register",body:{fullName:this.fullName,phoneNumber:this.phoneNumber,password:this.password},headers:{"Content-Type":"application/json"}}).then(e=>{this.success=e.message||t.registerSuccess,this.fullName="",this.phoneNumber="",this.password="",this.loading=!1,m.redraw()}).catch(e=>{this.error=e.error||"Pendaftaran gagal",this.loading=!1,m.redraw()})},view(){return m("main.container",[m("h1",t.register),m("form",{onsubmit:e=>{e.preventDefault(),this.register()}},[m("label",{for:"fullName"},t.fullName),m("input",{id:"fullName",type:"text",value:this.fullName,oninput:e=>{this.fullName=e.target.value},required:!0}),m("label",{for:"phoneNumber"},t.phoneNumber),m("input",{id:"phoneNumber",type:"tel",value:this.phoneNumber,oninput:e=>{this.phoneNumber=e.target.value},required:!0}),m("label",{for:"password"},t.password),m("input",{id:"password",type:"password",value:this.password,oninput:e=>{this.password=e.target.value},required:!0}),m("button[type=submit]",{disabled:this.loading},t.register),this.success&&m("div.success",this.success),this.error&&m("div.error",this.error)]),m("p",["Sudah punya akun? ",m("a",{href:"#!/app/login"},t.login)])])}};var d={tps:"",village:"",district:"",totalVotes:"",calegVotes:"",photo:null,latitude:"",longitude:"",loading:!1,error:"",success:"",hideFields:[],oninit(e){e.attrs&&e.attrs.prefill&&(this.village=e.attrs.prefill.village||"",this.district=e.attrs.prefill.district||""),e.attrs&&e.attrs.hideFields&&(this.hideFields=e.attrs.hideFields)},getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{this.latitude=e.coords.latitude,this.longitude=e.coords.longitude,m.redraw()},e=>{console.error("Error getting location:",e)})},handleFileUpload(e){let a=e.target.files[0];if(a){let i=new FileReader;i.onload=s=>{this.photoBase64=s.target.result.split(",")[1],this.photoMime=a.type,m.redraw()},i.readAsDataURL(a),this.photo=a}else this.photoBase64=null,this.photoMime=null,this.photo=null},async submit(){if(this.loading=!0,this.error="",this.success="",this.photo&&!this.photoBase64){this.error="Gambar masih diproses, mohon tunggu.",this.loading=!1,m.redraw();return}let e={tpsNumber:this.tps,village:this.village,district:this.district,votes:this.totalVotes,calegVotes:this.calegVotes,lat:this.latitude,lng:this.longitude,photoBase64:this.photoBase64,photoMime:this.photoMime};m.request({method:"POST",url:"/api/submissions",body:e,headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}}).then(a=>{this.success="Data berhasil dikirim!",this.resetForm(),this.loading=!1,m.redraw()}).catch(a=>{this.error=a.error||"Gagal mengirim data",this.loading=!1,m.redraw()})},resetForm(){this.tps="",this.totalVotes="",this.calegVotes="",this.photo=null,this.latitude="",this.longitude="",this.hideFields.includes("village")||(this.village=""),this.hideFields.includes("district")||(this.district="");let e=document.querySelector("#photo");e&&(e.value="")},view(){return m("form",{onsubmit:e=>{e.preventDefault(),this.submit()}},[!this.hideFields.includes("village")&&[m("label",{for:"village"},t.village),m("input",{id:"village",type:"text",value:this.village,oninput:e=>{this.village=e.target.value},required:!0})],!this.hideFields.includes("district")&&[m("label",{for:"district"},t.district),m("input",{id:"district",type:"text",value:this.district,oninput:e=>{this.district=e.target.value},required:!0})],m("label",{for:"tps"},t.tps),m("input",{id:"tps",type:"text",value:this.tps,oninput:e=>{this.tps=e.target.value},required:!0}),m("label",{for:"totalVotes"},t.totalVotes),m("input",{id:"totalVotes",type:"number",value:this.totalVotes,oninput:e=>{this.totalVotes=e.target.value},required:!0}),m("label",{for:"calegVotes"},t.calegVotes),m("input",{id:"calegVotes",type:"number",value:this.calegVotes,oninput:e=>{this.calegVotes=e.target.value},required:!0}),m("label",{for:"photo"},t.photo),m("input",{id:"photo",type:"file",accept:"image/*",onchange:e=>this.handleFileUpload(e)}),m("div",[m("label","Lokasi GPS"),m("button",{type:"button",onclick:()=>this.getLocation()},"Dapatkan Lokasi"),this.latitude&&this.longitude&&m("p",`Lat: ${this.latitude}, Lng: ${this.longitude}`)]),m("button[type=submit]",{disabled:this.loading},this.loading?"Mengirim...":t.submit),this.success&&m("div.success",this.success),this.error&&m("div.error",this.error)])}};var D=()=>{let e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}},l=e=>{let i={...D(),...e.headers};return m.request({...e,headers:i})},r=()=>{localStorage.removeItem("token"),m.route.set("/app/login")};var g={cursor:"pointer",textAlign:"center",padding:"calc(var(--spacing) * 1.5)",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"8rem"},b={margin:0,fontWeight:400},f={area:null,calegName:"",kecamatanList:[],desaList:[],selectedKecamatan:null,selectedDesa:null,loading:!0,loadingDesa:!1,loadingSubmissions:!1,userSubmissions:[],error:"",async oninit(){this.loading=!0,this.error="";try{let[e,a]=await Promise.all([l({method:"GET",url:"/api/admin/area-setting"}),l({method:"GET",url:"/api/caleg"}).catch(()=>({}))]);this.area=e,a&&a.name&&(this.calegName=a.name),this.area&&this.area.kabupatenKota&&this.area.provinsi&&this.calegName?this.kecamatanList=await l({method:"GET",url:`/api/kecamatan?kabupatenCode=${this.area.kabupatenKota}&provinsiCode=${this.area.provinsi}`}):this.kecamatanList=[]}catch(e){this.error=e.response?.error||"Gagal memuat data dasbor.",(e.code===401||e.code===403)&&r()}finally{this.loading=!1,m.redraw()}},async selectKecamatan(e){if(this.calegName){this.selectedKecamatan=e,this.desaList=[],this.loadingDesa=!0,this.error="",m.redraw();try{let{provinsi:a,kabupatenKota:i}=this.area;this.desaList=await l({method:"GET",url:`/api/kelurahan_desa?provinsiCode=${a}&kabupatenCode=${i}&kecamatanCode=${e.code}`})}catch(a){this.error=a.response?.error||"Gagal memuat daftar desa.",(a.code===401||a.code===403)&&r()}finally{this.loadingDesa=!1,m.redraw()}}},async selectDesa(e){this.selectedDesa=e,this.fetchUserSubmissions(e.code)},async fetchUserSubmissions(e){this.loadingSubmissions=!0,this.userSubmissions=[],m.redraw();try{this.userSubmissions=await l({method:"GET",url:`/api/submissions/mine?kelurahanDesaCode=${e}`})}catch(a){console.error("Could not fetch user's submissions",a)}finally{this.loadingSubmissions=!1,m.redraw()}},backToKecamatanList(){this.selectedKecamatan=null,this.selectedDesa=null,this.desaList=[],this.error=""},backToDesaList(){this.userSubmissions=[],this.selectedDesa=null},renderCalegInfoBox(){return this.calegName?m("article",{style:{marginBottom:"var(--spacing)",padding:"var(--spacing)",backgroundColor:"var(--pico-primary-background)",borderLeft:"4px solid var(--pico-primary)"}},m("p",{style:{margin:0,textAlign:"center",color:"white"}},["Anda mengumpulkan suara untuk Caleg:",m("br"),m("strong",{style:{fontSize:"1.2rem"}},this.calegName)])):null},view(){let a=JSON.parse(localStorage.getItem("user")||"{}").role==="admin";return this.loading?m("main.container",m("p",t.loading)):this.error&&!this.loadingDesa?m("main.container",[m("h2",t.dashboard),m("p.error",this.error),a&&m("button",{onclick:()=>m.route.set("/app/admin")},"Ke Halaman Admin"),m("button",{onclick:r},t.logout)]):!this.area||!this.area.kabupatenKota?m("main.container",[m("h2",t.dashboard),m("p","Area belum diatur oleh admin."),a&&m("button",{onclick:()=>m.route.set("/app/admin")},"Ke Halaman Admin"),m("button",{onclick:r},t.logout)]):this.selectedKecamatan&&this.selectedDesa?m("main.container",[m("h4",{style:{marginTop:"var(--spacing)"}},"Data Terkirim di Desa Ini"),this.loadingSubmissions?m("p",t.loading):this.userSubmissions.length>0?m("table",{role:"grid"},[m("thead",m("tr",[m("th","TPS"),m("th","Suara"),m("th","Foto"),m("th","GPS"),m("th","")])),m("tbody",this.userSubmissions.map(i=>m("tr",[m("td",i.tpsNumber),m("td",i.votes),m("td",i.hasPhoto?"\u2705":"\u274C"),m("td",i.hasLocation?"\u2705":"\u274C"),m("td",m("button",{class:"outline secondary",style:{margin:0,padding:"0.25rem 0.75rem",fontSize:"0.8rem",display:"flex",alignItems:"center",justifyContent:"center"},onclick:()=>m.route.set(`/app/submit/${i._id}`),title:"Edit"},"\u270F\uFE0F"))])))]):m("p","Belum ada data yang dikirim untuk desa ini."),m("hr"),m("h3",`Input Data untuk ${this.selectedDesa.name}`),this.calegName&&m("p",{style:{fontStyle:"italic",textAlign:"center",marginTop:"calc(var(--spacing) * -0.5)",marginBottom:"var(--spacing)"}},`(Suara untuk Caleg: ${this.calegName})`),m(d,{prefill:{village:this.selectedDesa.name,district:this.selectedKecamatan.name,provinsiCode:this.area.provinsi,kabupatenKotaCode:this.area.kabupatenKota,kecamatanCode:this.selectedKecamatan.code,kelurahanDesaCode:this.selectedDesa.code},hideFields:["village","district"],onsuccess:()=>{this.fetchUserSubmissions(this.selectedDesa.code)}}),m("footer",{style:{paddingTop:"var(--spacing)"}},m(".grid",m("button",{class:"secondary",onclick:()=>this.backToDesaList()},"Kembali ke Daftar Desa"),m("button",{class:"contrast",onclick:r},t.logout)))]):this.selectedKecamatan?m("main.container",[m("h2",t.dashboard),this.renderCalegInfoBox(),m("h3",`Pilih Desa/Kelurahan di Kecamatan ${this.selectedKecamatan.name}`),this.loadingDesa?m("p",t.loading):m(".grid",{style:{gridTemplateColumns:"repeat(auto-fit, minmax(12rem, 1fr))"}},this.desaList.map(i=>m("article",{onclick:()=>this.selectDesa(i),style:g},m("h3",{style:b},i.name)))),this.error&&m("p.error",this.error),m("footer",{style:{paddingTop:"var(--spacing)"}},m(".grid",m("button",{class:"secondary",onclick:()=>this.backToKecamatanList()},"Kembali ke Daftar Kecamatan"),m("button",{class:"contrast",onclick:r},t.logout)))]):m("main.container",[m("h2",t.dashboard),this.renderCalegInfoBox(),m("h3","Pilih Kecamatan"),!this.calegName&&m("p",{style:{color:"var(--pico-color-red-500)",fontWeight:500,marginBottom:"1rem"}},"Nama caleg belum diatur. Silakan hubungi admin."),m(".grid",{style:{gridTemplateColumns:"repeat(auto-fit, minmax(12rem, 1fr))"}},this.kecamatanList.map(i=>m("article",{onclick:this.calegName?()=>this.selectKecamatan(i):null,style:Object.assign({},g,this.calegName?{}:{opacity:.5,pointerEvents:"none",cursor:"not-allowed"})},m("h3",{style:b},i.name)))),m("footer",{style:{paddingTop:"var(--spacing)"}},[a&&m("button",{style:{marginRight:"1rem"},onclick:()=>m.route.set("/app/admin")},"Ke Halaman Admin"),m("button",{class:"contrast",onclick:r},t.logout)])])}};var v={provinsiList:[],kabupatenList:[],selectedProvinsi:"",selectedKabupaten:"",loading:!1,provinsiLoading:!0,kabupatenLoading:!1,success:"",error:"",areaSet:!1,areaDisplay:"",showEdit:!1,editSecret:"",editSecretError:"",oninit(){this.provinsiLoading=!0,m.request({method:"GET",url:"/api/provinsi"}).then(e=>{this.provinsiList=e,this.provinsiLoading=!1,m.redraw();let a=localStorage.getItem("token"),i=a?{Authorization:`Bearer ${a}`}:{};m.request({method:"GET",url:"/api/admin/area-setting",headers:i}).then(s=>{if(console.log("Fetched area setting:",s),s&&s.provinsi&&s.kabupatenKota){this.selectedProvinsi=s.provinsi,this.selectedKabupaten=s.kabupatenKota,this.areaSet=!0;let o=this.provinsiList.find(n=>n.code===s.provinsi);o?m.request({method:"GET",url:`/api/kabupatenkota?provinsiCode=${o.code}`}).then(n=>{this.kabupatenList=n;let h=this.kabupatenList.find(T=>T.code===s.kabupatenKota),y=o?o.name:s.provinsi,w=h?h.name:s.kabupatenKota;this.areaDisplay=`${y} / ${w}`,m.redraw()}):(this.areaDisplay=`${s.provinsi} / ${s.kabupatenKota}`,m.redraw())}else this.areaSet=!1})}).catch(()=>{this.provinsiLoading=!1,m.redraw()})},fetchKabupaten(){this.selectedProvinsi&&(this.kabupatenLoading=!0,console.log("Fetching kabupaten for provinsi:",this.selectedProvinsi),m.request({method:"GET",url:`/api/kabupatenkota?provinsiCode=${this.selectedProvinsi}`}).then(e=>{console.log("Fetched kabupaten list:",e),this.kabupatenList=e,this.kabupatenLoading=!1,m.redraw()}).catch(()=>{this.kabupatenList=[],this.kabupatenLoading=!1,m.redraw()}))},save(){this.loading=!0,this.success="",this.error="";let e=localStorage.getItem("token"),a=JSON.parse(localStorage.getItem("user")||"{}");console.log("[AREA SETTING] User from localStorage:",a);let i=e?{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}:{"Content-Type":"application/json"},s={provinsi:this.selectedProvinsi,kabupatenKota:this.selectedKabupaten,admin:a.id||a._id};console.log("[AREA SETTING] Sending POST body:",s),m.request({method:"POST",url:"/api/admin/area-setting",body:s,headers:i}).then(()=>{this.loading=!1,this.success="",this.error="",this.showEdit=!1,this.editSecret="";let o=this.provinsiList.find(n=>n.code===this.selectedProvinsi);this.areaDisplay=`${o?o.name:this.selectedProvinsi} / ${this.kabupatenList.find(n=>n.code===this.selectedKabupaten)?.name||this.selectedKabupaten}`,this.areaSet=!0,m.redraw()}).catch(()=>{this.error=t.saveError||"Gagal menyimpan",this.loading=!1,m.redraw()})},view(e){let a=e.attrs.hasSubmissions||!1;return this.provinsiLoading||this.selectedProvinsi===""&&!this.areaSet?m("section",[m("p","Memuat...")]):this.areaSet&&!this.showEdit?m("section",[m("h3",t.areaSetting||"Pengaturan Area"),m("div",[m("strong",t.currentArea||"Area Saat Ini:")," ",this.areaDisplay?m("span",this.areaDisplay):m("span","memuat..")]),m("button",{onclick:()=>{this.showEdit=!0},disabled:a},t.editArea||"Ubah Area"),a&&m("p",{style:{fontSize:"0.8rem",fontStyle:"italic",marginTop:"0.5rem",color:"var(--pico-color-red-500)"}},"Pengaturan tidak dapat diubah karena sudah ada data suara yang masuk.")]):m("section",[m("h3",t.areaSetting||"Pengaturan Area"),m("form",{onsubmit:i=>{i.preventDefault(),this.save()}},[m("label",{for:"provinsi"},t.province||"Provinsi"),m("select",{id:"provinsi",onchange:i=>{this.selectedProvinsi=i.target.value,this.selectedKabupaten="",this.kabupatenList=[],this.selectedProvinsi&&this.fetchKabupaten(),m.redraw()},value:this.selectedProvinsi,disabled:this.provinsiLoading},[this.provinsiLoading?m("option",{value:""},"Memuat..."):[m("option",{value:""},t.selectProvince||"Pilih Provinsi"),this.provinsiList.map(i=>m("option",{value:i.code},i.name))]]),m("label",{for:"kabupaten"},t.kabupatenKota||"Kabupaten/Kota"),m("select",{id:"kabupaten",onchange:i=>{this.selectedKabupaten=i.target.value},value:this.selectedKabupaten,disabled:!this.selectedProvinsi||this.kabupatenLoading},[this.kabupatenLoading?m("option",{value:""},"Memuat..."):[m("option",{value:""},t.selectKabupaten||"Pilih Kabupaten/Kota"),this.kabupatenList.map(i=>m("option",{value:i.code},i.name))]]),m("button[type=submit]",{disabled:this.loading},t.save||"Simpan"),this.success&&m("div.success",this.success),this.error&&m("div.error",this.error)])])}};var k={caleg:"",showEdit:!1,editSecret:"",editSecretError:"",loading:!1,error:"",oninit(){let e=localStorage.getItem("token"),a=e?{Authorization:`Bearer ${e}`}:{};m.request({method:"GET",url:"/api/caleg",headers:a}).then(i=>{i&&i.name?this.caleg=i.name:this.showEdit=!0,m.redraw()})},save(e){this.loading=!0,this.error="";let a=localStorage.getItem("token"),i=a?{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}:{"Content-Type":"application/json"};m.request({method:"POST",url:"/api/caleg",body:{name:e},headers:i}).then(s=>{this.caleg=s.name,this.showEdit=!1,this.editSecret="",this.editSecretError="",this.loading=!1,m.redraw()}).catch(()=>{this.error=t.saveError||"Gagal menyimpan",this.loading=!1,m.redraw()})},view(e){let a=e.attrs.hasSubmissions||!1;return this.caleg&&!this.showEdit?m("section",[m("h3",t.calegSetting||"Caleg"),m("div",[m("strong",t.currentCaleg||"Caleg Saat Ini:")," ",this.caleg]),m("button",{onclick:()=>{this.showEdit=!0},disabled:a},t.editCaleg||"Ubah Caleg"),a&&m("p",{style:{fontSize:"0.8rem",fontStyle:"italic",marginTop:"0.5rem",color:"var(--pico-color-red-500)"}},"Pengaturan tidak dapat diubah karena sudah ada data suara yang masuk.")]):m("section",[m("h3",t.calegSetting||"Caleg"),m("form",{onsubmit:i=>{i.preventDefault();let s=i.target.elements.caleg.value;this.save(s)}},[m("label",{for:"caleg"},t.calegName||"Nama Caleg"),m("input[type=text][name=caleg][id=caleg][autocomplete=off]"),m("button[type=submit]",{disabled:this.loading},t.save||"Simpan"),this.error&&m("div.error",this.error)])])}};var S={currentView:"dashboard",unverifiedUsers:[],submissions:[],loading:!1,error:"",oninit(){this.checkAdminAccess()},checkAdminAccess(){if(!localStorage.getItem("token")){m.route.set("/app/login");return}if(JSON.parse(localStorage.getItem("user")||"{}").role!=="admin"){m.route.set("/app/dashboard");return}this.loadDashboardData()},loadDashboardData(){this.loading=!0,Promise.all([this.loadUnverifiedUsers(),this.loadSubmissions()]).finally(()=>{this.loading=!1,m.redraw()})},loadUnverifiedUsers(){return m.request({method:"GET",url:"/api/admin/unverified-users",headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>{this.unverifiedUsers=e}).catch(e=>{this.error="Failed to load unverified users"})},loadSubmissions(){return m.request({method:"GET",url:"/api/admin/submissions",headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>{this.submissions=e}).catch(e=>{this.error="Failed to load submissions"})},verifyUser(e){m.request({method:"POST",url:`/api/admin/verify-user/${e}`,headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then(()=>{this.loadUnverifiedUsers()}).catch(a=>{this.error="Failed to verify user",m.redraw()})},approveSubmission(e){m.request({method:"POST",url:`/api/admin/approve/${e}`,headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then(()=>{this.loadSubmissions()}).catch(a=>{this.error="Failed to approve submission",m.redraw()})},flagSubmission(e){m.request({method:"POST",url:`/api/admin/flag/${e}`,headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"application/json"}}).then(()=>{this.loadSubmissions()}).catch(a=>{this.error="Failed to flag submission",m.redraw()})},renderDashboard(){return[m("h3","Admin Dashboard"),this.error&&m("div.error",this.error),m("div.grid",[m("article",[m("h4","Pengguna Belum Terverifikasi"),m("h2",this.unverifiedUsers.length)]),m("article",[m("h4","Total Submission"),m("h2",this.submissions.length)])]),m("section",[m("h4","Pengguna Belum Terverifikasi"),this.unverifiedUsers.length===0?m("p","Tidak ada pengguna yang perlu diverifikasi"):m("table",[m("thead",m("tr",[m("th","Nama"),m("th","No. HP"),m("th","Tanggal Daftar"),m("th","Aksi")])),m("tbody",this.unverifiedUsers.map(e=>m("tr",[m("td",e.fullName),m("td",e.phoneNumber),m("td",new Date(e.createdAt).toLocaleDateString("id-ID")),m("td",m("button",{onclick:()=>this.verifyUser(e._id)},"Verifikasi"))])))])]),m("section",[m("h4","Submission Terbaru"),this.submissions.length===0?m("p","Belum ada submission"):m("table",[m("thead",m("tr",[m("th","Volunteer"),m("th","TPS"),m("th","Desa"),m("th","Suara"),m("th","Status"),m("th","Aksi")])),m("tbody",this.submissions.slice(0,10).map(e=>m("tr",[m("td",e.volunteer?.fullName||"Unknown"),m("td",e.tps),m("td",e.village),m("td",`${e.calegVotes}/${e.totalVotes}`),m("td",e.status),m("td",[e.status==="pending"&&m("button",{onclick:()=>this.approveSubmission(e._id),style:{marginRight:"0.5rem"}},"Setujui"),m("button",{onclick:()=>this.flagSubmission(e._id),class:"secondary"},"Tandai")])])))])])]},view(){return this.loading?m("main.container",m("p","Loading...")):m("main.container",[m("nav",[m("ul",[m("li",m("button",{onclick:()=>{this.currentView="dashboard"},class:this.currentView==="dashboard"?"":"outline"},"Dashboard")),m("li",m("button",{onclick:()=>{this.currentView="area"},class:this.currentView==="area"?"":"outline"},"Pengaturan Area")),m("li",m("button",{onclick:()=>{this.currentView="caleg"},class:this.currentView==="caleg"?"":"outline"},"Pengaturan Caleg"))]),m("ul",[m("li",m("button",{onclick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),m.route.set("/app/login")},class:"contrast"},t.logout))])]),this.currentView==="dashboard"&&this.renderDashboard(),this.currentView==="area"&&m(v),this.currentView==="caleg"&&m(k)])}};var u=()=>!!localStorage.getItem("token");m.route.prefix="#!";m.route(document.body,"/app/login",{"/app/login":{render:()=>m(c)},"/app/register":{render:()=>m(p)},"/app/dashboard":{onmatch:()=>u()?void 0:m.route.set("/app/login"),render:()=>m(f)},"/app/submit":{onmatch:()=>u()?void 0:m.route.set("/app/login"),render:()=>m(d)},"/app/submit/:id":{onmatch:()=>u()?void 0:m.route.set("/app/login"),render:e=>m(d,{id:e.attrs.id})},"/app/admin":{render:()=>m(S)}});
